{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "Create Next.js project",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx create-next-app@latest . --typescript --eslint --tailwind --src-dir --app --import-alias '@/*' --use-npm --yes",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Create Next.js in tmp",
			"type": "shell",
			"command": "cd /tmp && rm -rf isi-frontend-tmp && npx create-next-app@latest isi-frontend-tmp --typescript --eslint --tailwind --src-dir --app --import-alias '@/*' --use-npm --yes 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Copy project files",
			"type": "shell",
			"command": "cp -a /tmp/isi-frontend-tmp/. /Users/sebastiandrazsky/isi-frontend/ 2>&1 && echo 'COPY COMPLETE'",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Sanity dev run",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && timeout 30 npm run dev 2>&1 || true",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Sanity dev check",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && (npm run dev &) && sleep 15 && curl -s -o /dev/null -w '%{http_code}' http://localhost:3000 && echo '' && echo 'DEV_SERVER_OK' && kill %1 2>/dev/null || (echo 'DEV_SERVER_FAIL' && kill %1 2>/dev/null)",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "HTTP check",
			"type": "shell",
			"command": "curl -s -o /dev/null -w '%{http_code}' http://localhost:3000 && echo '' && echo 'HTTP_CHECK_PASS'",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "TypeScript check",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx tsc --noEmit 2>&1 && echo 'TSC_PASS' || echo 'TSC_FAIL'",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "ESLint check",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npm run lint 2>&1 && echo 'ESLINT_PASS' || echo 'ESLINT_FAIL'",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Stop dev server",
			"type": "shell",
			"command": "lsof -ti:3000 | xargs kill -9 2>/dev/null; echo 'DEV_SERVER_STOPPED'",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Git stage",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && rm -rf .next && git add -A && git status 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Git log",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git log --oneline 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Check remote",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git remote -v 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Add remote",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git remote add origin https://github.com/burvolapp-arch/isi-frontend.git 2>&1 && echo 'REMOTE_ADDED'",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Git commit",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git rm --cached .vscode/tasks.json 2>/dev/null; echo '.vscode/' >> .gitignore && git add -A && git commit --amend -m 'chore: initialize ISI Next.js frontend scaffold' 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Verify commit",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git log --oneline 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "Git push",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git push --force origin main 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "TypeScript check",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx tsc --noEmit 2>&1; echo '---EXIT:' $?",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "tsc-noEmit-v2",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx tsc --noEmit 2>&1; echo 'TSC_EXIT:'$?",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "eslint-v2",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npm run lint 2>&1; echo 'LINT_EXIT:'$?",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "next-build",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npm run build 2>&1; echo 'BUILD_EXIT:'$?",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "git-stage",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git add -A && git status --short 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "git-diff-stat",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git diff --cached --stat 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "git-stat-full",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git diff --cached --stat 2>&1 | head -20",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "git-commit",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git commit -m 'feat: connect frontend to ISI backend API\n\n- Add TypeScript data contract (src/lib/types.ts) mirroring all backend JSON shapes\n- Add fetch-based API client (src/lib/api.ts) with typed endpoints\n- Add dashboard page rendering ISI composite scores, country rankings, axis registry\n- Add country detail page with per-axis breakdown, channels, partners, warnings\n- Add reusable components: KPICard, CountryTable, AxisCard, StatusBadge, ErrorPanel\n- Add environment configuration (.env.local, .env.example)\n- All data from backend API. Zero business logic in frontend.' 2>&1",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "git-push",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git push origin main 2>&1; echo 'PUSH_EXIT:'$?",
			"isBackground": false,
			"problemMatcher": []
		},
		{
			"label": "TypeScript check",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx tsc --noEmit"
		},
		{
			"label": "TSC verbose",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx tsc --noEmit 2>&1 | tail -50"
		},
		{
			"label": "TSC check 2",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx tsc --noEmit 2>&1 | tail -20"
		},
		{
			"label": "ESLint check",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npm run lint 2>&1 | tail -30"
		},
		{
			"label": "ESLint detail",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npm run lint 2>&1 | head -80"
		},
		{
			"label": "ESLint compact",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx eslint src/ --format compact 2>&1"
		},
		{
			"label": "ESLint to file",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx eslint src/ 2>&1 > /tmp/eslint-out.txt; cat /tmp/eslint-out.txt"
		},
		{
			"label": "ESLint full",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npx eslint src/ 2>&1 > src/lint-output.txt; cat src/lint-output.txt"
		},
		{
			"label": "ESLint recheck",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npm run lint 2>&1 > src/lint-output.txt; cat src/lint-output.txt"
		},
		{
			"label": "Next.js build",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npm run build 2>&1 > src/build-output.txt; echo \"EXIT:$?\" >> src/build-output.txt; cat src/build-output.txt"
		},
		{
			"label": "Git status",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && rm -f src/lint-output.txt src/build-output.txt && git add -A && git status"
		},
		{
			"label": "git-commit-redesign",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git commit -m 'feat: redesign into research-grade analytical platform\n\n- Add 4-layer architecture: Executive Overview, Country Deep Dive, Axis Deep Dive, Transparency Layer\n- Replace Panargus branding with International Sovereignty Institute / ISI\n- Add interactive CountryRankingsTable with sorting, filtering, search, tooltips, expand-row, deviation highlighting\n- Add format.ts utility module (formatScore, computePercentile, deviationFromMean, classificationLabel)\n- Redesign root layout with global nav (Overview, Methodology, Transparency, FAQ) and institutional footer\n- Rebuild Executive Overview with KPIs, distribution bar, interpretation guide, scope/limitations\n- Redesign country detail with percentile, strengths/vulnerabilities, axis contribution breakdown\n- Add axis deep dive page (/axis/[slug]) with cross-EU statistics and score distribution\n- Add static pages: /methodology, /transparency, /faq\n- Add loading skeletons, error boundaries, and 404 page for all routes\n- All data from backend API. Zero business logic in frontend.' 2>&1"
		},
		{
			"label": "git-log-verify",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git log --oneline -3 2>&1"
		},
		{
			"label": "git-log-full",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git log --oneline -3 > /tmp/gitlog.txt 2>&1 && cat /tmp/gitlog.txt"
		},
		{
			"label": "git-status-check",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git log --oneline -5 2>&1 | head -10 && echo '---' && git status --short 2>&1 | head -20"
		},
		{
			"label": "verify-commit",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git log --oneline -5 > /tmp/gl.txt && cat /tmp/gl.txt && echo '---STATUS---' && git status --short"
		},
		{
			"label": "full-log",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git log --oneline > /tmp/gl2.txt 2>&1 && cat /tmp/gl2.txt"
		},
		{
			"label": "check-staged",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git add -A && git diff --cached --stat | wc -l"
		},
		{
			"label": "count-commits",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git rev-list --count HEAD"
		},
		{
			"label": "git-push-redesign",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && git push origin main 2>&1; echo PUSH_EXIT:$?"
		},
		{
			"label": "Install @microsoft/clarity",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npm install @microsoft/clarity"
		},
		{
			"label": "Install topojson-server",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && npm install --save-dev topojson-server topojson-simplify topojson-client"
		},
		{
			"label": "Generate EU27 TopoJSON",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node scripts/generate-eu27-topo.mjs"
		},
		{
			"label": "Generate EU27 TopoJSON v2",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node scripts/generate-eu27-topo.mjs"
		},
		{
			"label": "Check file size",
			"type": "shell",
			"command": "wc -c /Users/sebastiandrazsky/isi-frontend/public/eu27.topo.json"
		},
		{
			"label": "Generate EU27 TopoJSON v3",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node scripts/generate-eu27-topo.mjs"
		},
		{
			"label": "Verify TopoJSON",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node -e \"const t = require('./public/eu27.topo.json'); console.log('bbox:', t.bbox); console.log('arcs:', t.arcs.length); const g = t.objects.countries.geometries; g.forEach(gg => console.log(gg.properties.ISO_A2, gg.type));\""
		},
		{
			"label": "Generate EU27 TopoJSON (10m high-res)",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node scripts/generate-eu27-topo.mjs"
		},
		{
			"label": "Verify TopoJSON quality",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && wc -c public/eu27.topo.json && node -e \"const t=require('./public/eu27.topo.json'); console.log('arcs:', t.arcs.length, 'bbox:', t.bbox); let pts=0; t.arcs.forEach(a=>pts+=a.length); console.log('total points:', pts);\""
		},
		{
			"label": "Test 10m download",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node -e \"fetch('https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_10m_admin_0_countries.geojson').then(r => {console.log('status:', r.status, 'type:', r.headers.get('content-type')); return r.text()}).then(t => {console.log('size:', t.length, 'bytes'); try { const j = JSON.parse(t); console.log('features:', j.features.length)} catch(e){console.log('not valid json, first 200 chars:', t.substring(0,200))}}).catch(e => console.error(e))\""
		},
		{
			"label": "Measure simplification levels",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node -e \"\nconst { topology } = require('topojson-server');\nconst { presimplify, quantile, simplify } = require('topojson-simplify');\n\nasync function test() {\n  const r = await fetch('https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_10m_admin_0_countries.geojson');\n  const world = await r.json();\n  const eu = world.features.filter(f => {\n    const iso = f.properties.ISO_A2 !== '-99' ? f.properties.ISO_A2 : (f.properties.ISO_A2_EH !== '-99' ? f.properties.ISO_A2_EH : null);\n    return ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE'].includes(iso);\n  });\n  console.log('EU features:', eu.length);\n  const geojson = {type:'FeatureCollection',features:eu};\n  let topo = topology({countries:geojson}, 1e5);\n  let pts=0; topo.arcs.forEach(a=>pts+=a.length);\n  console.log('before simplify — arcs:', topo.arcs.length, 'points:', pts);\n  topo = presimplify(topo);\n  const q005 = quantile(topo, 0.005);\n  const q01 = quantile(topo, 0.01);\n  const q02 = quantile(topo, 0.02);\n  console.log('quantiles — 0.5%:', q005, '1%:', q01, '2%:', q02);\n  const s005 = simplify(presimplify(topology({countries:geojson}, 1e5)), q005);\n  let p2=0; s005.arcs.forEach(a=>p2+=a.length);\n  console.log('after 0.5% simplify — points:', p2);\n}\ntest();\n\""
		},
		{
			"label": "Generate EU27 TopoJSON (10m near-lossless)",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node scripts/generate-eu27-topo.mjs"
		},
		{
			"label": "Check point count",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node -e \"const t=require('./public/eu27.topo.json'); let pts=0; t.arcs.forEach(a=>pts+=a.length); console.log('arcs:', t.arcs.length, 'points:', pts, 'size:', JSON.stringify(t).length, 'bytes');\""
		},
		{
			"label": "Generate EU27 TopoJSON (10m high-res v2)",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node scripts/generate-eu27-topo.mjs"
		},
		{
			"label": "Generate EU27 TopoJSON (10m, 0.3% simplify)",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node scripts/generate-eu27-topo.mjs"
		},
		{
			"label": "Test quantile levels",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node -e \"\nconst {topology} = require('topojson-server');\nconst {presimplify, quantile, simplify} = require('topojson-simplify');\nconst fs = require('fs');\n\nasync function test() {\n  const r = await fetch('https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_10m_admin_0_countries.geojson');\n  const world = await r.json();\n  const ISO_MAP = {France:'FR'};\n  function iso(f) { return f.properties.ISO_A2 !== '-99' ? f.properties.ISO_A2 : f.properties.ISO_A2_EH !== '-99' ? f.properties.ISO_A2_EH : ISO_MAP[f.properties.NAME] ?? null; }\n  const EU = new Set(['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE']);\n  const feats = world.features.filter(f=>EU.has(iso(f))).map(f=>({type:'Feature',geometry:f.geometry,properties:{ISO_A2:iso(f),NAME:f.properties.NAME}}));\n  const gc = {type:'FeatureCollection',features:feats};\n  let topo = topology({countries:gc}, 1e6);\n  topo = presimplify(topo);\n  for (const p of [0.01, 0.02, 0.05, 0.10, 0.15, 0.20, 0.30]) {\n    const th = quantile(topo, p);\n    const s = simplify(presimplify(topology({countries:gc},1e6)), th);\n    let pts=0; s.arcs.forEach(a=>pts+=a.length);\n    const kb = (JSON.stringify(s).length/1024).toFixed(0);\n    console.log('p=' + p.toFixed(2) + ' threshold=' + th.toFixed(6) + ' points=' + pts + ' size=' + kb + 'KB');\n  }\n}\ntest();\n\""
		},
		{
			"label": "Generate EU27 TopoJSON (10m final)",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node scripts/generate-eu27-topo.mjs"
		},
		{
			"label": "Verify all 27 countries",
			"type": "shell",
			"command": "cd /Users/sebastiandrazsky/isi-frontend && node -e \"const t=require('./public/eu27.topo.json'); console.log('bbox:', t.bbox); const g=t.objects.countries.geometries; g.forEach(gg=>console.log(gg.properties.ISO_A2, gg.properties.NAME, gg.type)); console.log('total:', g.length);\""
		},
		{
			"label": "Regenerate EU27 TopoJSON (10m, p=0.20 high-accuracy)",
			"type": "shell",
			"command": "node scripts/generate-eu27-topo.mjs"
		},
		{
			"label": "Verify TopoJSON quality",
			"type": "shell",
			"command": "node -e \"const t=JSON.parse(require('fs').readFileSync('public/eu27.topo.json','utf8')); const g=t.objects.countries.geometries; console.log('Countries:',g.length); console.log(g.map(x=>x.properties.ISO_A2).sort().join(', ')); let pts=0; t.arcs.forEach(a=>pts+=a.length); console.log('Total points:',pts.toLocaleString()); console.log('File size:',(JSON.stringify(t).length/1024).toFixed(1),'KB');\""
		}
	]
}